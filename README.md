

# Supplementaty Material for the paper and Replication Guide


## Data Collected and processed to build the AutoSimTest Framework

### S-Agent Knowledge Base 
sUAS incident data collected from multiple sources and used to construct the knowledge base of the S-agent can be accessed here: [S-Agent Knowledge Base](AutoSIMTestFramework/knowledga_base.csv)

### A-Agent Knowledge Base
Data collected and used to build the knowledge-base of Analytics Agent can be found [here](Px4 Flight Controller Params)


## Data Prepared to Analyze the agents of the AutoSimTest Framework

### Px4 Flight Logs Prepared to analyze Anlaytics-Agent
These flight logs were generated by injecting failures in the PX4 flight controller. The logs were used to analyze the performance of the Analytics-Agent. Please access the flight logs here: [Failure Injected Flight Logs](FlightLogs-FailureInjection). The code developed to simulate run-time sensor errors during Simulation can be found [here](https://github.com/UAVLab-SLU/AutoSimTestFramework/blob/67d000b0ea4d8f7486b28b4a23126e110c01b556/SuT/px4/standalone)

### Model-Based Design of Mission inputs for 5 different sUAS use-cases
The mission inputs were generated using the model-based design approach for 5 different sUAS use-cases. The mission inputs can be accessed [here](SuT/px4/standalone). This data was used to analyze whether the Mission-Agent can generate correct mission inputs for different sUAS use-cases.


### Implementation of Px4 and Ardupilot based SuT.
We designed our own System-Under-Tests. The implementation of these SuT can be found [here](SuT). We tested our SuT using the AutoSimTest Framework. 

    - Sample of Expected Mission Input by Px4 can be found here - @Bohan Can you link the file here correctly
    - Sample of Airsim Settings to execute a Px4 Mission can be found [here](SuT/px4/airsim-setting-sample.json)
    - Sample of Expected Mission Input by Ardupilot can be found here - @Bohan Can you link the file here correctly
    - Sample of Aurdupilot-Sitl Simulator input can be found here - @Bohan Can you link the file here correctly


## Data Generated by the AutoSimTest Framework

### Scenarios Generated by S-Agent acros 5 sUAS use-case
The scenarios generated by the S-Agent across 5 sUAS use-cases can be accessed [here](Analysis/Generalizability/S-Agent Scenario.xlsx)


### Analytics Report Generated by the Analytics Agent

### Simulation Tool Config Files genetated by the Environment Agent

### Mission Config files generated by the Mission Agent




#Responses generated by  s-agent,Misson-Agent and Environment Agent :-



#Knowledge Base used for Analytiscs RAGS Agent :-https://github.com/UAVLab-SLU/AutoSimTestFramework/blob/main/AutoSIMTestFramework/Analytics_Agent_knowledge_base.csv








# AutoSimTestFramework - Impementation and Set-up Details

### AUTOSIMTEST Framework Codebase

The implementation of the AutoSimTest Framework including all Agents and communication between then is available here [AutoSimTestFramework](https://github.com/UAVLab-SLU/AutoSimTestFramework/tree/main/AutoSIMTestFramework) for replication and further research and analysis. 

### Flight Control relay
Description:
`llm_relay` contains the code for the PX4 and ardu relay. The relay is responsible for communicating with the flight controller firmware using Mavsdk server.

## Input Mission format

Waypoint based mission
first param is the speed of the drone
second param is the list of waypoints
```json
{
            "Mission": {
                "name": "Search_and_Rescue_Mission",
                "param": [
                    20,
                    [
                        [
                            0,
                            0,
                            0
                        ],
                        [
                            0,
                            10,
                            -5
                        ],
                        [
                            10,
                            10,
                            -5
                        ],
                        [
                            10,
                            0,
                            -5
                        ],
                        [
                            0,
                            10,
                            -5
                        ],
                        [
                            0,
                            0,
                            0
                        ]
                    ]
                ]
            }
        }
```

Automated misson
```
{
    "Mission": {
        "name": "Search_and_Rescue_Mission",
        "mode": "auto",
        "center": [0, 0, 0],
        "radius": 10,
        "height": 5
    }
}
```
## PX4
replace the IP address with the IP address of the host machine
```bash
cd Firmware
export PX4_SIM_HOST_ADDR=192.168.1.181
make px4_sitl_default none_iris
```

## ardupilot

### build and run docker
```
git clone https://github.com/ArduPilot/ardupilot.git
cd ardupilot
git submodule update --init --recursive
docker build . -t ardupilot
docker run --rm -it -v `pwd`:/ardupilot ardupilot:latest bash
```
### inside docker
```
sim_vehicle.py -v copter --console --map -w
```


## drone kit ardupilot

install dronekit
```
pip install dronekit-sitl
pip install mavproxy
```

start 
```
dronekit-sitl copter --home=35.98,-9.5.87,0,180
```
```
mavproxy.py --master tcp:127.0.0.1:5760 --out udp:127.0.0.1:14551 --out udp:10.55.222.120:14550
```

then use python script to connect to the dronekit
Note: this script need python 3.9 to run, 3.10+ will not work due to syntax in dronekit
```
python llm_relay/ardu/dronekit_mission.py
```

## logs
ArduPilot logs are in .tlog format, you can use mavlogdump.py to convert it to human readable format


