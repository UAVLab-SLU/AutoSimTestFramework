

# Supplementaty Material for Replication and Future Research

## Data collected and processed to build the AutoSimTest Framework

### S-Agent Knowledge Base 
sUAS incident data collected from multiple sources and used to construct the knowledge base of the S-agent can be accessed here: [S-Agent Knowledge Base](AutoSIMTestFramework/knowledga_base.csv)

### A-Agent Knowledge Base
Data collected and used to build the knowledge-base of Analytics Agent can be found [here](Px4-Flight-Controller-Params)


## Data prepared to analyze the agents of the AutoSimTest Framework

### Px4 Flight Logs Prepared to analyze Anlaytics-Agent
These flight logs were generated by injecting failures in the PX4 flight controller. The logs were used to analyze the performance of the Analytics-Agent. Please access the flight logs here: [Failure Injected Flight Logs](FlightLogs-FailureInjection). The code developed to simulate run-time sensor errors during Simulation can be found [here](SuT/px4/standalone)

### Model-Based Design of Mission inputs for 5 different sUAS use-cases
The mission inputs were generated using the model-based design approach for 5 different sUAS use-cases. The mission inputs can be accessed [here](Sample-of-Expected-Output/Mission-Samples-For-Each-Use-Case). This data was used to analyze whether the Mission-Agent can generate correct mission inputs for different sUAS use-cases.


### Implementation of Px4 and Ardupilot based SuT.
We designed our own System-Under-Tests. The implementation of these SuT can be found [here](SuT). We tested our SuT using the AutoSimTest Framework. 

Sample of Expected Mission Input by Px4 can be found [here](SuT/px4/standalone/rq1.py)

Sample of Airsim Settings to execute a Px4 Mission can be found [here](SuT/px4/airsim-setting-sample.json)

Sample of Expected Mission Input by Ardupilot can be found [here](SuT/ardu/standalone/rq1-1.py)

Sample of Aurdupilot-Sitl Simulator input can be found here [here](https://github.com/Akademicki-Klub-Lotniczy/ardupilot-sitl-docker/blob/master/docker-compose.yml)


## Data generated by the AutoSimTest Framework

### Scenarios Generated by S-Agent acros 5 sUAS use-case
The scenarios generated by the S-Agent across 5 sUAS use-cases can be accessed [here](Analysis/Generalizability/S-Agent-Scenario.xlsx)

### Mission and Environment Config Files generated by the Mission and Environment Agents across the 5 Use-Cases
@Aswath - Please add the data to github and links its relative path here

### Analytics Report Generated by the Analytics-Agent
@Aswath - Please add the data to github and links its relative path here

# AutoSimTestFramework - Impementation and Set-up Details

### AUTOSIMTEST Framework Codebase

The implementation of the AutoSimTest Framework including all Agents and communication between then is available here [AutoSimTestFramework](https://github.com/UAVLab-SLU/AutoSimTestFramework/tree/main/AutoSIMTestFramework) for replication and further research and analysis.

### AutoSimTestFramework Setup Guide

Follow these steps to set up and run the AUTOSIMTEST Framework Codebase.

---

## Prerequisites
- Install [Conda](https://docs.conda.io/en/latest/miniconda.html).
- Ensure you have Python installed and available in your system PATH.

---

## Installation Steps

1. **Clone the Repository**  
   ```bash
   git clone https://github.com/UAVLab-SLU/AutoSimTestFramework.git
   cd AutoSimTestFramework/AutoSimTestFramework
   ```

2. **Create and Activate a Virtual Environment**  
   ```bash
   conda create -n autosim_env python=3.8
   conda activate autosim_env
   ```

3. **Install Dependencies**  
   ```bash
   pip install -r requirements.txt
   ```

---

## Running the Framework

1. **Run the Flask Backend**  
   ```bash
   python app.py
   ```

2. **Run the Gradio Frontend** 
   - Launch the Gradio-based frontend for communicating with the S-Agent, Env-Agent, and M-Agent

   ```bash
   python frontend2.py
   ```

   **Run the Gradio Frontend**  
   - Launch the Gradio-based frontend for communicating with Analytics-Agent

   ```bash
   python Analytics_Agent_front_end.py
   ```
   

## Px4 Flight Controller based SuT

- Mission Input Sample
- Simulation Config Sample
### Execution Instructions
```bash
git clone https://github.com/PX4/PX4-Autopilot.git Firmware
cd Firmware
git submodule update --init --recursive
```


replace the IP address with the IP address of the host machine
```bash
cd Firmware
export PX4_SIM_HOST_ADDR=192.168.1.181
make px4_sitl_default none_iris
```

## Ardupilot Flight Controller based SuT

- Mission Input Sample
- Simulation Config Sample

### Execution Instructions

#### build and run docker
```
git clone https://github.com/ArduPilot/ardupilot.git
cd ardupilot
git submodule update --init --recursive
docker build . -t ardupilot
docker run --rm -it -v `pwd`:/ardupilot ardupilot:latest bash
```
#### inside docker
```
sim_vehicle.py -v copter --console --map -w
```

### drone kit ardupilot

install dronekit
```
pip install dronekit-sitl
pip install mavproxy
```

#### Execution Instructions

Start the Dronekit SITL simulator:
```
dronekit-sitl copter --home=35.98,-9.5.87,0,180
```

#### Run the MAVProxy tool to establish connections:

```
mavproxy.py --master tcp:127.0.0.1:5760 --out udp:127.0.0.1:14551 --out udp:10.55.222.120:14550
```

Execute the Python script to connect to Dronekit:
Note: Ensure Python 3.9 is used for running the script, as later versions might be incompatible with Dronekit.
```
python SuT/ardu/dronekit_mission.py
```

### logs
ArduPilot logs are in .tlog format, you can use mavlogdump.py to convert it to human readable format

## Other Common Components of SuT

<!-- ### Flight Control relay
Description:
`llm_relay` contains the code for the PX4 and ardu relay. The relay is responsible for communicating with the flight controller firmware using Mavsdk server. -->

## Input Mission format

Waypoint based mission
first param is the speed of the drone
second param is the list of waypoints
```json
{
            "Mission": {
                "name": "Search_and_Rescue_Mission",
                "param": [
                    20,
                    [
                        [
                            0,
                            0,
                            0
                        ],
                        [
                            0,
                            10,
                            -5
                        ],
                        [
                            10,
                            10,
                            -5
                        ],
                        [
                            10,
                            0,
                            -5
                        ],
                        [
                            0,
                            10,
                            -5
                        ],
                        [
                            0,
                            0,
                            0
                        ]
                    ]
                ]
            }
        }
```

Automated misson
```
{
    "Mission": {
        "name": "Search_and_Rescue_Mission",
        "mode": "auto",
        "center": [0, 0, 0],
        "radius": 10,
        "height": 5
    }
}
```






